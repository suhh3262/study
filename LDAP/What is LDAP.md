# 💡 LDAP과 AD의 차이점
- `AD` : IT 자산을 구성하는데 사용되는 Microsoft 제품
- `LDAP` : 서비스가 아닌 프로토콜! AD를 포함해 다양한 유형의 디렉토리와 통신 및 쿼리하는데 사용

<br>

### 1. Active Directory
- 사용자와 컴퓨터에 대한 정보를 단일 디렉토리에 저장하여 더욱 쉽게 간리
- AD의 자산은 도메인, 트리, 포레스트로 분류
  1. 도메인 : 동일한 AD DB를 공유하는 사용자와 디바이스가 도메인에 해당. 보통 기업 또는 기업 부서와 관련 있음
  2. 트리 : 도메인 간 신뢰 관계를 정의하여 기업 부서마다 누가 어디에 액세스할 수 있는지 결정
  3. 포레스트 : 규모가 큰 기업이나 기업 간 관계일 때 도메인은 포레스트로 그룹화됨.
- 보안 기능
  - 인증 : 자격증명
  - 보안 그룹
  - 그룹 정책

### 2. LDAP
- 애플리케이션에서 사용자 정보를 매우 빠르게 대규모로 쿼리할 수 있도록 설계되어 이동통신이나 항공 산업 등의 분야에 적합
- `AD`는 수천 명에 이르는 기업을 대상으로 설계된 반면, `LDAP`은 수백만 건에 달하는 모바일 네트워크 구독자의 인증 요청을 처리해야 하는 이동통신 사업자의 애플리케이션 프로토콜로 설계
- LDAP은 제품 유형에 구애받지 않음. 실제로 LDAP를 지원하도록 구현된 AD에서는 기존의 AD 환경과 달리 LDAP 기반의 애플리케이션도 실행됨

<br>

---

# 1. What is LDAP? 🧐
![Image](https://github.com/user-attachments/assets/f7d34be8-9233-404d-9262-3827c8cd3a60)
- Lightweight Directory Access Protocol
- client-server 아키텍처를 사용하여 네트워크에서 액세스할 수 있는 중앙 정보 디렉토리를 만들 수 있는 안정적 수단 제공
- 클라이언트가 이 디렉터리 내에서 정보를 수정하려고 하면, 서버에서 사용자에게 변경을 수행할 수 있는 권한이 있는지 확인 후 요청된 대로 항목을 추가하거나 업데이트
- 통신의 보안을 유지하기 위해 TLS (Transport Layer Security) 암호화 프로토콜을 사용하여 공격자가 전송을 가로채지 않도록 할 수 있음
- 여러 데이터베이스 시스템을 지원하므로 관리자가 서비스하려는 정보 유형에 가장 적합한 솔류선 선택 가능

<br>

### LDAP 용어
- `DN` : LDAP 디렉터리 내의 단일 단위. 각 항목은 DN(Distinguished Name)으로 식별
- `LDIF` : LDAP Data Interchange Format, LDAP 항목의 일반 텍스트 표현
    ```
    [id] dn: distinguished_name
    attribute_type: attribute_value…
    attribute_type: attribute_value…
    ...
    ```
    - 선택사항인 `ID`는 항목을 편집하는데 사용되는 애플리케이션에 의해 결정된 숫자
    - 각 항목에는 모두 해당 스키마 파일에 정의된 한 개수의 attribute_type 및 attribute_value 쌍을 필요에 따라 포함할 수 있음
    - 빈 줄은 항목의 끝을 나타냄
- `DIT`: LDAP에서 탐색할 디렉토리 정보 트리


<br>

### LDAP 인증 프로세스
LDAP 인증 프로세스는 Client-Server 인증 모델로, 다음과 같은 주요 요소로 구성
- `DSA(Directroy System Agent)`: 네트워크에서 LDAP을 실행하는 서버
- `DUA(Directory User Agent)`: DSA에 클라이언트(e.g., 사용자의 PC)로 액세스
- `DN(Distinguished Name)`: LDAP에서 탐색할 디렉토리 정보 트리(DIT)를 통한 경로가 포함된 고유 이름
  - e.g., cn=Suhyeon, ou-users, o=Company
- `RDN(Relative Distinguished Name)`: DN 내 경로의 각 구성요소 (e.g., cn=Suhyeon)
- `API`: API를 사용하면 다른 제품/서비스의 구현 방식을 몰라도 보유한 제품/서비스와 다른 제품/서비스가 서로 통신할 수 있음

사용자가 PC에서 비즈니스 이메일 애플리케이션과 같은 LDAP 지원 클라이언트 프로그램에 액세스를 시도할 때 이 프로세스가 시작됩니다.
LDAPv3에서는 두 가지 사용 가능한 인증 방법, 즉 로그인 자격 증명이 있는 SSO와 같은 `단순 인증` 또는 Kerberos와 같은 프로그램에 LDAP 서버를 바인딩하는 `SASL 인증` 중 하나를 거칩니다. 로그인을 시도하면 사용자에게 할당된 DN을 인증하는 요청이 전송됩니다. DN은 DSA를 시작하는 클라이언트 API 또는 서비스를 통해 전송됩니다.

<br>

 클라이언트는 자동으로 DSA에 바인딩되고 LDAP은 DN을 사용하여 LDAP 데이터베이스의 레코드에 대해 일치하는 오브젝트 또는 오브젝트 집합을 검색합니다. 이 단계에서 DN의 RDN이 매우 중요한데, 개인을 찾을 수 있도록 DIT를 통한 LDAP 검색의 각 단계를 제공하기 때문입니다. 경로에서 백엔드에 연결 RDN이 없으면 결과가 유효하지 않은 것으로 나타날 수 있습니다. 이 경우 LDAP이 검색하는 오브젝트는 개별 사용자 계정(cn)이며 디렉터리의 계정에 일치하는 uid 및 userPassword가 있는 경우에만 사용자를 검증할 수 있습니다. 사용자 그룹은 LDAP 디렉토리 내의 오브젝트로도 식별됩니다.

<br>

 사용자가 응답(유효성 여부)을 받으면 LDAP 서버에서 클라이언트의 바인딩이 해제됩니다. 그러면 인증된 사용자가 시스템 관리자가 부여한 권한에 따라 필요한 파일, 사용자 정보 및 기타 애플리케이션 데이터를 포함하여 API 및 해당 서비스에 액세스할 수 있습니다.

<br>

### LDAP 구성요소
##### 도메인 액세스 구성 요소(dc)
- dc=com, dc=example
- DNS 매핑을 사용하여 인터넷 도메인 이름을 찾은 후 이를 IP 주소로 변환
- LDAP은 사용자에게 할당된 DN을 경로로 사용하여 DIT를 빠르게 탐색하고 검색 결과를 찾음. 여기에서 o 하위 클래스가 나타남

##### 조직 이름(o)
- e.g., o-Company
- DN에 나열된 가장 일반적인 클래스 중 하나로, 보통 LDAP이 검색을 실행할 때 시작되는 위치
- 예를 들어, 단순 경로는 일반적으로 o 하위 클래스로 시작하여 조직단위(ou)로 분기한 다음 사용자 계정 또는 그룹이 이어짐

##### 조직 단위(ou)
- ou는 o의 하위 클래스이며 종종 ou=users 또는 ou=group으로 표시
- 각 사용자 계정 또는 그룹 목록이 포함되어 있음
- o-Company
  - ou=groups
    - cn=developers
  - ou=users
    - cn=Suhyeon
   
##### 일반 이름(cn)
- 그룹 또는 개별 사용자 계정의 이름 식별할 때 사용

##### 속성 및 값
- LDAP DIT의 각 하위 클래스(e.g., o,ou,cn)에 포함되는 속성과 값 또는 스키마에는 LDAP 디렉토리 구조에 대한 정보가 포함되어 있어 검색 범위를 좁히는 데 도움이 될 수 있음
- cn=Suhyeon 계정에서 uid+userPassword=`속성`, 사용자의 로그인 자격증명=`값`

<br>

### LDAP 사용 이유
- 회사 인트라넷과 같이 일상적인 태스크를 위해 사용자 역할과 파일에 대한 액세스를 기반으로 액세스 제어 및 정책을 할당할 책임 존재
- LDAP을 환경에 통합하기 전 고려해야 할 사항
  - 용량: 모든 데이터를 저장하고 관리할 수 있는가
  - 검색 빈도: 회사 인트라넷, 이메일 애플리케이션 또는 서비스와 같이 사용자가 매일 액세스해야 하는 데이터가 있다면 LDAP가 적합할 수 있음
  - 조직





